fPhi=function(N0) n/sum(1/(N0-(1:(n-1))*interfail)
fN0=function(N0)  sum(interfail)*phi(N0)-sum(1/(N0-(1:(n-1)))


JMmodel <- function(data){
n=length(data)
interfail[1]=data[1,2]
for(i in 2:n){
interfail[i]=data[i,2]-data[i-1,2]}


N0 = uniroot(fN0,lower = n, upper=150,tol=1e-9)$root
Phi = fPhi(N0)

for(i in 1:data[n,2]){
reliability[i,1] = i
reliability[i,2] =  exp(Phi * (N0 - n) * i)}

return(reliability)
}


