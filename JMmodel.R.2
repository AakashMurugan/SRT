fPhi <- function(N0,interfail,n){
#n = length(interfail)
Phi = n/sum(1/(N0-(1:(n-1)))*interfail[1:(n-1)])
return(Phi)}

fN0 <- function(N0,interfail,n){
#n=length(interfail)
Nnot = sum(interfail)*fPhi(N0,interfail)-sum(1/(N0-(1:(n-1))))
return(Nnot)}



JMmodel <- function(data){
n=c()
n=length(data)
interfail = c()
interfail[1]=data[1,2]
for(i in 2:n){
interfail[i]=data[i,2]-data[i-1,2]}

N0 = uniroot(function(N0) fN0(N0,interfail,n),lower=n,upper=150,tol=1e-9)$root
Phi = fPhi(N0,interfail,n)

reliability = c()
for(tnow in 1:data[n,2]){
reliability[tnow,1] = tnow
reliability[tnow,2] =   exp(Phi * (N0 - n) * tnow)
}
return(reliability)
}


